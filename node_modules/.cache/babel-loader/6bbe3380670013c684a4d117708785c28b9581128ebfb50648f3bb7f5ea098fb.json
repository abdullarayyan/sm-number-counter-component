{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport grapesjs from 'grapesjs';\nimport 'grapesjs/dist/css/grapes.min.css';\nconst GrapesJSEditor = () => {\n  _s();\n  useEffect(() => {\n    const editor = grapesjs.init({\n      container: '#gjs',\n      fromElement: true,\n      storageManager: {\n        type: 'local'\n      },\n      plugins: ['gjs-blocks-basic']\n    });\n\n    // Define the NumberCounter component\n    editor.DomComponents.addType('number-counter', {\n      model: {\n        defaults: {\n          traits: [{\n            type: 'number',\n            name: 'start',\n            label: 'Start Value',\n            default: 0 // Default value for the trait\n          }, {\n            type: 'number',\n            name: 'end',\n            label: 'End Value',\n            default: 100 // Default value for the trait\n          }, {\n            type: 'number',\n            name: 'speed',\n            label: 'Speed (ms)',\n            default: 1000 // Default value for the trait\n          }, {\n            type: 'select',\n            name: 'direction',\n            label: 'Direction',\n            options: [{\n              value: 'up',\n              name: 'Up'\n            }, {\n              value: 'down',\n              name: 'Down'\n            }],\n            default: 'up' // Default value for the trait\n          }]\n        }\n      },\n\n      // label: 'NumberCounter',\n      // attributes: { class: 'fa fa-clock-o' },\n      // content: '<div data-gjs-type=\"number-counter\" data-gjs-draggable=\"true\">0</div>',\n      onUpdate({\n        component,\n        traits\n      }) {\n        console.log('xxx', traits, component);\n      }\n    });\n    editor.BlockManager.add('number-counter-block', {\n      label: 'NumberCounter',\n      attributes: {\n        class: 'fa fa-clock-o'\n      },\n      content: '<div data-gjs-type=\"number-counter\" data-gjs-draggable=\"true\">0</div>'\n    });\n\n    // editor.on('block:drag:start', (block) => { \n    //   console.log(block,'start')\n    //  });\n    //  editor.on('block:drag', (block) => { \n    //   console.log(block,'drag')\n    //   });\n    // const modal = editor.Modal;\n    // console.log(modal)\n    // editor.on('block:drag:stop', (component, block) => { \n    //   console.log(block,component.traits,'stop')\n    //   if (component.is('number-counter')) {\n    //     // Add your logic to set up the counter component here\n    //     // const start = component.getTrait('start').get('default');\n    //     // const end = component.getTrait('end').get('default');\n    //     // const speed = component.getTrait('speed').get('default');\n    //     // const direction = component.getTrait('direction').get('default');\n\n    //     // // Your logic to set up the counter based on traits\n    //     // console.log('Start:', start, 'End:', end, 'Speed:', speed, 'Direction:', direction);\n    //   }\n    //  });\n\n    // // Handle the event after a component is dragged and dropped\n    // editor.on('component:drag:end', (component) => {\n    //   console.log(component)\n    //   if (component.is('number-counter')) {\n    //     // Add your logic to set up the counter component here\n    //     const start = component.getTrait('start').get('value');\n    //     const end = component.getTrait('end').get('value');\n    //     const speed = component.getTrait('speed').get('value');\n    //     const direction = component.getTrait('direction').get('value');\n\n    //     // Your logic to set up the counter based on traits\n    //     console.log('Start:', start, 'End:', end, 'Speed:', speed, 'Direction:', direction);\n    //   }\n    // });\n\n    editor.on('block:drag:stop', component => {\n      if (component.is('number-counter')) {\n        // Get the trait values\n\n        let start = component.getTrait('start').get('default');\n        let end = component.getTrait('end').get('default');\n        let speed = component.getTrait('speed').get('default');\n        let direction = component.getTrait('direction').get('default');\n        console.log('Start:', start, 'End:', end, 'Speed:', speed, 'Direction:', direction);\n\n        // Access the counter component\n        const counterElement = component.view.el;\n\n        // Reset the counter's content\n        counterElement.innerHTML = start;\n\n        // Function to update the counter\n        const updateCounter = () => {\n          console.log('Start:', start, 'End:', end, 'Speed:', speed, 'Direction:', direction);\n          const current = parseInt(counterElement.innerHTML, 10);\n          console.log(current, 'current');\n          if (direction === 'up' && current < end) {\n            console.log('up');\n            counterElement.innerHTML = direction === 'up' ? current + 1 : current - 1;\n            setTimeout(updateCounter, speed);\n          }\n          if (direction === 'down' && current > end) {\n            console.log('down');\n            counterElement.innerHTML = current - 1;\n            setTimeout(updateCounter, speed);\n          }\n        };\n\n        // Start the counter\n        updateCounter();\n        ['start', 'end', 'speed', 'direction'].forEach(traitName => {\n          component.getTrait(traitName).on('change:value', e => {\n            const startInput = component.getTrait('start').get('value');\n            const endInput = component.getTrait('end').get('value');\n            const speedInput = component.getTrait('speed').get('value');\n            const directionInput = component.getTrait('direction').get('value');\n            counterElement.innerHTML = component.getTrait('start').get('value');\n            if (editor) {\n              const component = editor.getSelected();\n              if (component && component.is('number-counter')) {\n                component.getTrait('start').set('default', startInput);\n                component.getTrait('end').set('default', endInput);\n                component.getTrait('speed').set('default', speedInput);\n                component.getTrait('direction').set('default', directionInput);\n                direction = component.getTrait('direction').get('default');\n                start = component.getTrait('start').get('default');\n                end = component.getTrait('end').get('default');\n                speed = component.getTrait('speed').get('default');\n                updateCounter();\n              }\n            }\n          });\n        });\n      }\n    });\n    // const initialComponent = editorInstance.getSelected();\n    // if (initialComponent && initialComponent.is('number-counter')) {\n    //   startCounter(initialComponent);\n    // }\n  }, []);\n\n  // return (\n  //   <div>\n  //     <div id=\"gjs\" style={{ height: '500px' }}></div>\n  //     <div id=\"blocks\" style={{ display: 'none' }}></div>\n  //   </div>\n  // );\n};\n_s(GrapesJSEditor, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = GrapesJSEditor;\nexport default GrapesJSEditor;\nvar _c;\n$RefreshReg$(_c, \"GrapesJSEditor\");","map":{"version":3,"names":["React","useEffect","grapesjs","GrapesJSEditor","_s","editor","init","container","fromElement","storageManager","type","plugins","DomComponents","addType","model","defaults","traits","name","label","default","options","value","onUpdate","component","console","log","BlockManager","add","attributes","class","content","on","is","start","getTrait","get","end","speed","direction","counterElement","view","el","innerHTML","updateCounter","current","parseInt","setTimeout","forEach","traitName","e","startInput","endInput","speedInput","directionInput","getSelected","set","_c","$RefreshReg$"],"sources":["/Users/user/grapesjs-editor/src/NumberCounterBlock.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport grapesjs from 'grapesjs';\nimport 'grapesjs/dist/css/grapes.min.css';\n\nconst GrapesJSEditor: React.FC = () => {\n  useEffect(() => {\n    const editor = grapesjs.init({\n      container: '#gjs',\n      fromElement: true,\n      storageManager: {\n        type: 'local',\n      },\n      plugins: ['gjs-blocks-basic'],\n    });\n\n    // Define the NumberCounter component\n    editor.DomComponents.addType('number-counter', {\n      model:{\n        defaults: {\n            traits: [\n              {\n                type: 'number',\n                name: 'start',\n                label: 'Start Value',\n                default: 0, // Default value for the trait\n              },\n              {\n                type: 'number',\n                name: 'end',\n                label: 'End Value',\n                default: 100, // Default value for the trait\n              },\n              {\n                type: 'number',\n                name: 'speed',\n                label: 'Speed (ms)',\n                default: 1000, // Default value for the trait\n              },\n              {\n                type: 'select',\n                name: 'direction',\n                label: 'Direction',\n                options: [\n                  { value: 'up', name: 'Up' },\n                  { value: 'down', name: 'Down' },\n                ],\n                default: 'up', // Default value for the trait\n              },\n            ],\n        }\n      },\n      // label: 'NumberCounter',\n      // attributes: { class: 'fa fa-clock-o' },\n      // content: '<div data-gjs-type=\"number-counter\" data-gjs-draggable=\"true\">0</div>',\n      onUpdate({ component,traits }) {\n      console.log('xxx',traits,component)\n      }\n    });\n    editor.BlockManager.add('number-counter-block', {\n      label: 'NumberCounter',\n      attributes: { class: 'fa fa-clock-o' },\n      content: '<div data-gjs-type=\"number-counter\" data-gjs-draggable=\"true\">0</div>',\n    });\n   \n    // editor.on('block:drag:start', (block) => { \n    //   console.log(block,'start')\n    //  });\n    //  editor.on('block:drag', (block) => { \n    //   console.log(block,'drag')\n    //   });\n    // const modal = editor.Modal;\n    // console.log(modal)\n      // editor.on('block:drag:stop', (component, block) => { \n      //   console.log(block,component.traits,'stop')\n      //   if (component.is('number-counter')) {\n      //     // Add your logic to set up the counter component here\n      //     // const start = component.getTrait('start').get('default');\n      //     // const end = component.getTrait('end').get('default');\n      //     // const speed = component.getTrait('speed').get('default');\n      //     // const direction = component.getTrait('direction').get('default');\n  \n      //     // // Your logic to set up the counter based on traits\n      //     // console.log('Start:', start, 'End:', end, 'Speed:', speed, 'Direction:', direction);\n      //   }\n      //  });\n\n\n    // // Handle the event after a component is dragged and dropped\n    // editor.on('component:drag:end', (component) => {\n    //   console.log(component)\n    //   if (component.is('number-counter')) {\n    //     // Add your logic to set up the counter component here\n    //     const start = component.getTrait('start').get('value');\n    //     const end = component.getTrait('end').get('value');\n    //     const speed = component.getTrait('speed').get('value');\n    //     const direction = component.getTrait('direction').get('value');\n\n    //     // Your logic to set up the counter based on traits\n    //     console.log('Start:', start, 'End:', end, 'Speed:', speed, 'Direction:', direction);\n    //   }\n    // });\n    \n\n    editor.on('block:drag:stop', (component) => {\n      if (component.is('number-counter')) {\n        // Get the trait values\n\n        let start = component.getTrait('start').get('default');\n        let end = component.getTrait('end').get('default');\n        let speed = component.getTrait('speed').get('default');\n        let direction = component.getTrait('direction').get('default');\n        console.log('Start:', start, 'End:', end, 'Speed:', speed, 'Direction:', direction);\n\n        // Access the counter component\n        const counterElement = component.view.el;\n\n        // Reset the counter's content\n        counterElement.innerHTML =  start ;\n\n        // Function to update the counter\n        const updateCounter = () => {\n          console.log('Start:', start, 'End:', end, 'Speed:', speed, 'Direction:', direction);\n\n          const current = parseInt(counterElement.innerHTML, 10);\n          console.log(current,'current')\n          if ((direction === 'up' && current < end)) {\n            console.log('up')\n            counterElement.innerHTML = direction === 'up' ? current + 1 : current - 1;\n            setTimeout(updateCounter, speed);\n          }\n          if((direction === 'down' && current > end)){\n            console.log('down')\n            counterElement.innerHTML =  current - 1;\n            setTimeout(updateCounter, speed);\n          }\n        };\n\n        // Start the counter\n        updateCounter();\n        ['start', 'end', 'speed', 'direction'].forEach((traitName) => {\n          component.getTrait(traitName).on('change:value', (e) => {\n        \n            const startInput = component.getTrait('start').get('value');\n            const endInput = component.getTrait('end').get('value');\n            const speedInput = component.getTrait('speed').get('value');\n            const directionInput = component.getTrait('direction').get('value');\n\n            counterElement.innerHTML = component.getTrait('start').get('value');\n\n            if (editor) {\n              const component = editor.getSelected();\n              if (component && component.is('number-counter')) {\n                component.getTrait('start').set('default', startInput);\n                component.getTrait('end').set('default', endInput);\n                component.getTrait('speed').set('default', speedInput);\n                component.getTrait('direction').set('default', directionInput);\n\n                direction = component.getTrait('direction').get('default');\n                start = component.getTrait('start').get('default')\n                end = component.getTrait('end').get('default');\n                speed = component.getTrait('speed').get('default');\n                updateCounter();\n              }\n            }\n          });\n        });\n      }\n    });\n    // const initialComponent = editorInstance.getSelected();\n    // if (initialComponent && initialComponent.is('number-counter')) {\n    //   startCounter(initialComponent);\n    // }\n  }, []);\n  \n\n  // return (\n  //   <div>\n  //     <div id=\"gjs\" style={{ height: '500px' }}></div>\n  //     <div id=\"blocks\" style={{ display: 'none' }}></div>\n  //   </div>\n  // );\n};\n\nexport default GrapesJSEditor;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}